# Peony-Qt的文件操作

## 使用线程和信号槽

永远不要尝试在主线程中进行这种繁重的io操作，所有文件操作有一个继承自QRunnable的接口，并且应该被设计为同步且阻塞的，我使用Qt的线程池启动一个文件操作，使用接口的提供的信号连接主线程中对应控件的槽进行交互。

## 文件操作的接口

在peony-qt中，文件操作的接口大概可以分为三类：

* FileOperation的信号接口
* 处理FileOperation异常的槽接口
* 响应FileOperation状态变化的槽接口

其中第二个接口是每一个文件操作必须要实现的接口，它必须使用阻塞式的连接方式，等待槽函数的返回值；第三种接口不一定要实现，但是用户可能会因为一个文件操作还没有完成就进行一些有危险的操作，导致数据被破坏，所以还是建议在复杂操作时实现这类接口。

在这种接口设计的模式下，文件操作的前后端可以做到完全的分离，这意味着我们可以在不影响文件操作的情况下，随意的修改ui，如果觉得我的ui写的丑的话，你自己DIY一个也无妨，这种思路会贯穿整个Peony-Qt的设计流程，也是其它文件管理器开发框架不具备的一个设计特色。

